<div class="row section-observations-filter">
  <div class="col-md-12">
    <div style="float: left; margin-right: 10px">
      <p-toggleButton
        onLabel="{{ 'observations.showTable' | translate }}"
        offLabel="{{ 'observations.showTable' | translate }}"
        onIcon="fa fa-table"
        offIcon="fa fa-table"
        [(ngModel)]="showTable"
      ></p-toggleButton>
      <p-toggleButton
        onLabel="{{ 'observations.showMap' | translate }}"
        offLabel="{{ 'observations.showMap' | translate }}"
        onIcon="fa fa-map"
        offIcon="fa fa-map"
        [(ngModel)]="showMap"
      ></p-toggleButton>
    </div>
    <div style="float: left; margin-right: 10px">
      <p-calendar [(ngModel)]="dateRange" selectionMode="range" [showIcon]="true" dateFormat="dd.mm.yy"></p-calendar>
      <button type="button" pButton class="ui-button-secondary" (click)="loadObservations({days: 1})" label="1d"></button>
      <button type="button" pButton class="ui-button-secondary" (click)="loadObservations({days: 2})" label="2d"></button>
      <button type="button" pButton class="ui-button-secondary" (click)="loadObservations({days: 3})" label="3d"></button>
      <button type="button" pButton class="ui-button-secondary" (click)="loadObservations({days: 7})" label="7d"></button>
    </div>
    <div style="float: left; margin-right: 10px">
      <div class="ui-inputgroup">
        <span class="ui-inputgroup-addon"><i class="fa fa-tree"></i></span>
        <input style="width: 50px" type="text" step="100" min="0" max="9000" pInputText [(ngModel)]="elevationRange[0]" />
        <span class="ui-inputgroup-addon">&mdash;</span>
        <input style="width: 50px" type="text" pInputText [(ngModel)]="elevationRange[1]" />
        <span class="ui-inputgroup-addon">m</span>
      </div>
    </div>
    <div style="float: left; margin-right: 10px">
      <app-aspects [(aspects)]="aspects" [size]="50"></app-aspects>
    </div>
    <div style="float: right">
      <button
        type="button"
        pButton
        class="ui-button-success"
        (click)="loadObservations()"
        [icon]="loading ? 'pi pi-spin pi-spinner' : 'pi pi-refresh'"
      ></button>
    </div>
  </div>
</div>

<div *ngIf="showTable" style="margin-top: 70px" class="row">
  <div class="col-md-12">
    <div class="card">
      <div class="card-header">{{ "sidebar.observations" | translate }}</div>
      <div class="card-block">
        <div>
          <app-observation-table [observations]="observations"></app-observation-table>
        </div>
      </div>
    </div>
  </div>
</div>

<div [ngStyle]="{ display: showMap ? '' : 'none' }" class="row">
  <div class="section-observations-map col-md-12" id="mapDiv">
    <div class="section-map observations-map" id="map"></div>
  </div>
  <p-dialog
    [(visible)]="activeTableDialog"
    [modal]="true"
    [style]="{ width: '80vw' }"
    [closeOnEscape]="true"
    [dismissableMask]="true"
  >
    <table *ngIf="activeTable">
      <tr *ngFor="let row of activeTable">
        <th>{{ row.label }}</th>
        <td>
          <span *ngIf="row.date !== undefined">{{ row.date | localizedDate: "full" }}</span>
          <span *ngIf="row.number !== undefined">{{ row.number | number }}</span>
          <span *ngIf="row.boolean !== undefined"><i [class]="row.boolean ? 'pi pi-check' : 'pi pi-times'"></i></span>
          <span *ngIf="row.value !== undefined">{{ row.value }}</span>
          <span *ngIf="row.date === undefined && row.number === undefined && row.boolean === undefined && row.value === undefined">&mdash;</span>
        </td>
      </tr>
    </table>
  </p-dialog>
</div>
